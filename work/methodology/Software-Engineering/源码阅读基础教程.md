# 源码阅读基础教程


## 源码阅读技巧

### 断点调试法


在 IDEA 等 IDE 中，支持设置行断点、方法断点、属性断点、异常断点等，合理利用这些断点来进行 Debug，可以帮助自己加速理解代码逻辑。

参考：[IDEA-Debug调试基础教程](work/tools/IT/JetBrains/IDEA/IDEA-Debug调试基础教程.md)

### 调用栈阅读与回退法

在 IDEA 中可以在 Debugger 菜单中通过点击、回退方法栈 Frame，来查看 JVM 程序执行时的调用链，进而了解程序的运行过程。


![](resources/images/Pasted%20image%2020240912225124.png)

![](resources/images/Pasted%20image%2020230916203912.png)

### AI 工具法

#### Copilot Chat

源码阅读时，可以通过 VSCode、JetBrain 的插件等方式使用 copilot chat，来让 copilot 帮忙阅读源码，此方式准确率和效率都很高。

#### ChatGPT


### 注释法

自己拉取对应的框架、组件的源码，在本地使用之前的方式进行阅读，并通过增加注释的方式来记录其过程。缺点是，代码变动时，注释也难以维护。

### 笔记法

见下章节。

## 源码阅读笔记

此方法是目前本人主要使用的方法，通过记录独立笔记的方式记录源码中各个部分的功能，笔记和源码独立维护。优点是与代码解耦，方便查询。

### 常用笔记工具

源码阅读工具，对应开发语言的 IDE，如 JetBrain 系列
源码笔记工具，VSCode 编辑器，ProcessOn 思维导图

### 源码引用方法

JetBrain IDE 中在对应源码的方法位置，右键菜单选择 `Copy Reference`，即可复制当前源码的引用，如 `com.blanca.BlancaRunner#main`，可用于后续做源码笔记。

建议将 `Copy Reference` 功能的 KeyMap 中设置对应的快捷键，便于快捷操作。

### 源码笔记格式

代码的执行过程，实际上可以使用一种树形结构来进行表示。树的分支，即代表代码的分支，而树的节点，即代表该部分顺序执行的代码。

建议源码阅读笔记和源码分开保存，其中源码笔记主要以源码节选，加上代码注释组成。

源码笔记格式推荐：
1. 表示纵向执行逻辑时，可以通过普通文本来记录笔记内容，笔记中通过缩进来表示代码的层级和引用关系
2. 表示横向执行逻辑时，即代码执行分支，可以通过 mind map 思维导图的方式来表示，如 processOn 等工具
3. 代码每次调用方法时，则在对应的笔记位置，记录调用方法的引用 `Reference`，然后再去记录对应方法中的源码笔记
4. 文件后缀，建议使用对应源码后缀，如 `java`，使得代码编辑器支持代码关键词和特殊符号识别，也支持某些快捷键，如注释快捷键（`Ctrl+/`）

```java
com.tom.rrs.blanca.BlancaRunner#main:
    int exitCode = runApp(args);
        com.tom.rrs.blanca.BlancaRunner#runApp
            EtlContext etlContext = EtlContextFactory.getOrCreateEngineContext(args);
                // 依据AppModule中定义的装载过程, 创建 Injector, 其中 Injector 是对应模块的注入类的管理器 
                Injector injector = Guice.createInjector(new AppModule(args, true));
                    // 创建 AppModule 实例
                    com.tom.rrs.blanca.api.AppModule#AppModule

                    // createInjector 调用 AppModule 模块的 configure 方法
                    com.tom.rrs.blanca.api.AppModule#configure
                        // 部署 PostConstructModule 模块, 主要用于执行 GuicePostConstruct 注解的方法
                        install(new PostConstructModule());
                            com.tom.rrs.blanca.guice.PostConstructModule#configure
                                // 添加监听器, 配置在每次 Inject 注入实例时触发当前(this)的 hear 方法
                                binder.bindListener(Matchers.any(), this);
```


## 参考链接

1. [3 个一直在用的 idea 源码阅读小技巧 | 最后一个很多人不知道 | 效率提升 1000%-哔哩哔哩](https://www.bilibili.com/video/BV1FY411Q7W2)
2. [B 站史上最强：开源框架源码阅读方法](https://www.bilibili.com/video/BV1sq4y1g7X1)