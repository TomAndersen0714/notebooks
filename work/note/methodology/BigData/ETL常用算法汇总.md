# ETL常用算法汇总

## 前言

参考《阿里巴巴大数据实践之路》



## 概览

ETL算法要求是幂等的，重试时保证数据不会出错



ETL算法分类：



基础算法

全量更新：truncate+select+insert

增量更新：delete+select+insert

PS：select代表抽取满足条件的数据，insert代表直接写入，delete代表删除满足条件的数据，truncate代表删除表中的所有数据



高级算法

历史拉链表：按天拉链，按月拉链



## 算法详解



### 算法一

#### 算法描述

#### 伪代码实现

#### SQL实现

基于ClickHouse SQL





### 算法二

#### 算法描述

#### 伪代码实现

#### SQL实现



## ETL算法实现准则

幂等性



## 总结

ETL算法选择思路（基于数据的存储需求）：

1. 数据是否会需要更新？否，则优先选择增量拉取（select+insert），即先全量拉取已有数据（可选），然后T+1拉取增量数据直接insert，数据量小，也可以直接全量拉取（truncate+select+insert）；是，则进入步骤2
2. 数据更新时是否需要保留历史状态？否，则判断数据更新的比例，如果更新比例较大，且数据量较小，则全删全插；是，则进入步骤3
3. 若数据更新时需要保留历史状态，则进行拉链。



《kimball数仓工具箱-维度建模权威指南》

